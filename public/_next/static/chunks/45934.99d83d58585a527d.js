"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[45934],{45934:function(e,n,t){t.r(n),t.d(n,{default:function(){return C}});var r=t(85893),i=t(72161),l=t(477),o=t(31931),c=t(67294),a=t(15879),s=t(8985),x=t(44581);let d=(0,x.lx)({animation:`${s.BX} 0.15s ease-in`});var u=t(86889),g=t(37275),f=t(20070),h=t(63680);function m(e){let n=e.value.split(""),t=n=>{e.setValue(n.join(""))},i=n.length,l=(0,c.useRef)([]);return(0,c.useEffect)(()=>{l.current[i]&&requestAnimationFrame(()=>{l.current[i]?.focus()})},[i]),(0,r.jsx)(f.W2,{center:"x",gap:"sm",flex:"row",children:Array(e.digits).fill(null).map((o,c)=>(0,r.jsx)(y,{"data-error":e.isInvalid,ref:e=>l.current[c]=e,value:n[c]??"",type:"text",pattern:"[a-zA-Z0-9]*",variant:"outline",inputMode:"text",onPaste:n=>{t(n.clipboardData.getData("text/plain").slice(0,e.digits).split("")),n.preventDefault()},onKeyDown:r=>{if("Enter"===r.key&&e.onEnter){e.onEnter();return}if("ArrowLeft"===r.key){if(0===c)return;l.current[c-1]?.focus();return}if("ArrowRight"===r.key){if(c===e.digits-1)return;l.current[c+1]?.focus();return}if("e"===r.key||"."===r.key){r.preventDefault();return}if("Backspace"===r.key){if(0===c)return;t(n.slice(0,-1))}},onChange:e=>{let r=e.target.value;if(r.length>1){let e=r[r.length-1];e&&(r=e)}if(!/\d/.test(r)&&""!==r){e.preventDefault();return}let l=[...n];l[c>i-1?i:c]=r,t(l)}},c))})}let y=(0,t(83202).Z)(h.II)(()=>{let e=(0,u.v)();return{appearance:"none",WebkitAppearance:"none",width:"40px",height:"40px",textAlign:"center",fontSize:g.JB.md,padding:g.W0.xs,[g.BC.mobile]:{width:"35px",height:"35px"},"&[data-verify-status='invalid']":{color:e.colors.danger,borderColor:e.colors.danger}}});var j=t(57654),p=t(67544),v=t(69538),w=t(15794),k=t(11079),E=t(33477);function L(e){let{wallet:n,done:t,goBack:i}=e,l=e.email,{modalSize:o}=(0,c.useContext)(a.Tg),s="wide"===o,x=e.locale,[u,g]=(0,c.useState)(""),{client:h,chain:y}=(0,k.H)(),[L,W]=(0,c.useState)("idle"),[S,C]=(0,c.useState)("sending"),[b]=(0,c.useState)("base"),B=(0,c.useCallback)(async()=>{g(""),W("idle"),C("sending");try{let e=await (0,E.u)({email:l,strategy:"email",client:h});C(e)}catch(e){console.error(e),W("idle"),C("error")}},[h,l]),T=async e=>{if("object"==typeof S&&6===e.length&&(W("idle"),"object"==typeof S&&n))try{if(W("verifying"),"USER_MANAGED"===S.recoveryShareManagement&&(S.isNewUser||S.isNewDevice)){if(S.isNewUser)try{await n.connect({chain:y,strategy:"email",email:l,verificationCode:e,client:h})}catch(e){if(e instanceof Error&&e.message.includes("encryption key"));else throw e}else try{await n.connect({chain:y,strategy:"email",email:l,verificationCode:e,client:h})}catch(e){if(e instanceof Error&&e.message.includes("encryption key"));else throw e}}else{if(!await n.connect({chain:y,strategy:"email",email:l,verificationCode:e,client:h}))throw Error("Failed to verify OTP");t()}W("valid")}catch(e){e?.message?.includes("PAYMENT_METHOD_REQUIRED")?W("payment_required"):W("invalid"),console.error("Authentication Error",e)}},D=(0,c.useRef)(!1);return((0,c.useEffect)(()=>{D.current||(D.current=!0,B())},[B]),"base"===b)?(0,r.jsxs)(f.W2,{fullHeight:!0,flex:"column",animate:"fadein",children:[(0,r.jsx)(f.W2,{p:"lg",children:(0,r.jsx)(f.xB,{title:x.signIn,onBack:i})}),(0,r.jsx)(f.W2,{expand:!0,flex:"column",center:"y",children:(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault()},children:[(0,r.jsxs)(f.W2,{flex:"column",center:"x",px:"lg",children:[!s&&(0,r.jsx)(j.L,{y:"xl"}),(0,r.jsx)(w.x,{children:x.emailLoginScreen.enterCodeSendTo}),(0,r.jsx)(j.L,{y:"sm"}),(0,r.jsx)(w.x,{color:"primaryText",children:l}),(0,r.jsx)(j.L,{y:"xl"})]}),(0,r.jsx)(m,{isInvalid:"invalid"===L,digits:6,value:u,setValue:e=>{g(e),W("idle"),T(e)},onEnter:()=>{T(u)}}),"invalid"===L&&(0,r.jsxs)(d,{children:[(0,r.jsx)(j.L,{y:"md"}),(0,r.jsx)(w.x,{size:"sm",color:"danger",center:!0,children:x.emailLoginScreen.invalidCode})]}),"payment_required"===L&&(0,r.jsxs)(d,{children:[(0,r.jsx)(j.L,{y:"md"}),(0,r.jsx)(w.x,{size:"sm",color:"danger",center:!0,children:x.maxAccountsExceeded})]}),(0,r.jsx)(j.L,{y:"xl"}),(0,r.jsx)(f.W2,{px:s?"xxl":"lg",children:"verifying"===L?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(f.W2,{flex:"row",center:"x",animate:"fadein",children:(0,r.jsx)(p.$,{size:"lg",color:"accentText"})})}):(0,r.jsx)(f.W2,{animate:"fadein",children:(0,r.jsx)(v.zx,{onClick:()=>T(u),variant:"accent",type:"submit",style:{width:"100%"},children:x.emailLoginScreen.verify})},"btn-container")}),(0,r.jsx)(j.L,{y:"xl"}),!s&&(0,r.jsx)(f.x1,{}),(0,r.jsxs)(f.W2,{p:s?void 0:"lg",children:["error"===S&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(w.x,{size:"sm",center:!0,color:"danger",children:x.emailLoginScreen.failedToSendCode})}),"sending"===S&&(0,r.jsxs)(f.W2,{flex:"row",center:"both",gap:"xs",style:{textAlign:"center"},children:[(0,r.jsx)(w.x,{size:"sm",children:x.emailLoginScreen.sendingCode}),(0,r.jsx)(p.$,{size:"xs",color:"secondaryText"})]}),"object"==typeof S&&(0,r.jsx)(A,{onClick:B,type:"button",children:x.emailLoginScreen.resendCode})]})]})})]}):null}let A=(0,x.Sn)(()=>{let e=(0,u.v)();return{all:"unset",color:e.colors.accentText,fontSize:g.JB.sm,cursor:"pointer",textAlign:"center",fontWeight:500,width:"100%","&:hover":{color:e.colors.primaryText}}});var W=t(71452);function S(e){let n=e.locale,t=n.socialLoginScreen,i=(0,u.v)(),{modalSize:l}=(0,c.useContext)(a.Tg),[o,s]=(0,c.useState)(void 0),{done:x,wallet:d}=e,[g,h]=(0,c.useState)("connecting"),{client:m,chain:y}=(0,k.H)(),E=async()=>{try{let n=(0,W.P)(e.socialAuth,i);if(!n)throw Error(`Failed to open ${e.socialAuth} login window`);h("connecting"),await d.connect({chain:y,strategy:e.socialAuth,openedWindow:n,closeOpenedWindow:e=>{e.close()},client:m}),h("connected"),x()}catch(t){h("error"),t?.message?.includes("PAYMENT_METHOD_REQUIRED")&&s(n.maxAccountsExceeded),console.error(`Error sign in with ${e.socialAuth}`,t)}},L=e.state?.socialLogin,A=(0,c.useRef)(!1);return(0,c.useEffect)(()=>{!A.current&&L&&(A.current=!0,h("connecting"),L.connectionPromise.then(()=>{x(),h("connected")}).catch(()=>{h("error")}))},[x,L]),(0,r.jsx)(f.W2,{animate:"fadein",flex:"column",fullHeight:!0,children:(0,r.jsxs)(f.W2,{flex:"column",expand:!0,p:"lg",style:{paddingBottom:0},children:[(0,r.jsx)(f.xB,{title:t.title,onBack:e.goBack}),"compact"===l?(0,r.jsx)(j.L,{y:"xl"}):null,(0,r.jsxs)(f.W2,{flex:"column",center:"both",expand:!0,style:{textAlign:"center",minHeight:"250px"},children:["error"!==g&&(0,r.jsxs)(f.W2,{animate:"fadein",children:[(0,r.jsx)(w.x,{color:"primaryText",center:!0,multiline:!0,style:{maxWidth:"250px"},children:t.instruction}),(0,r.jsx)(j.L,{y:"xl"}),(0,r.jsx)(f.W2,{center:"x",flex:"row",children:(0,r.jsx)(p.$,{size:"lg",color:"accentText"})}),(0,r.jsx)(j.L,{y:"xxl"})]}),"error"===g&&(0,r.jsxs)(f.W2,{animate:"fadein",children:[(0,r.jsx)(w.x,{color:"danger",children:t.failed}),o&&(0,r.jsx)(w.x,{color:"danger",children:o}),(0,r.jsx)(j.L,{y:"lg"}),(0,r.jsx)(v.zx,{variant:"primary",onClick:E,children:t.retry}),(0,r.jsx)(j.L,{y:"xxl"})]})]})]})})}var C=function(e){let{data:n}=(0,c.useContext)(a.Tg),t=(0,o.q)();return t?n?.emailLogin?(0,r.jsx)(L,{email:n.emailLogin,locale:t,done:e.done,goBack:e.goBack,wallet:e.wallet}):n?.socialLogin?(0,r.jsx)(S,{socialAuth:n.socialLogin.type,locale:t,done:e.done,goBack:e.goBack,wallet:e.wallet,state:n}):(0,r.jsx)(i.A,{select:()=>{},locale:t,done:e.done,goBack:e.goBack,wallet:e.wallet}):(0,r.jsx)(l.a,{})}}}]);